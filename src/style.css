:root{
  --bg0:#0b0b12;
  --bg1:#101022;
  --paper:#fff7f1;
  --ink:#1b1b22;
  --rose:#ff4d6d;
  --envFront:#c99277;
  --envBack:#b9856c;
  --envEdge:#6d3a2f;
  --shadow: 0 18px 40px rgba(0,0,0,.35);
  --serif: "Fraunces", ui-serif, Georgia, serif;
  --script: "Allura", cursive;
}

* { box-sizing:border-box; }
html,body{ height:100%; }

::-webkit-scrollbar { display: none; }

body{
  margin:0;
  font-family: var(--serif);
  color:#f6f4ff;
  background: #cca9dd;
}

.stage{
  min-height:100%;
  display:grid;
  place-items:center;
  padding:20px;
}

.envelope{
  position:relative;
  width:min(560px, 100%);
  aspect-ratio: 16/11;
  border-radius: 18px;
  display:grid;
  place-items:center;
  user-select:none;
  isolation: isolate;
  perspective: 900px;
  transform-style: preserve-3d;
}

.env{
  position:absolute;
  inset:0;
  border-radius: 18px;
}

.env--back{
  z-index: 1;
  background: linear-gradient(180deg, var(--envBack), #a56f58);
  border: 2px solid rgba(0,0,0,.15);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.08);
}

.flap{
  position:absolute;
  inset:0;
  border-radius: 18px;
  z-index: 8;
  background: linear-gradient(180deg, #a56f58, var(--envEdge));
  clip-path: polygon(0 0, 100% 0, 50% 66%);
  transform-origin: 50% 0%;
  transform: rotateX(0deg);
  transition: transform .75s cubic-bezier(.2,.8,.1,1);
  transform-style: preserve-3d;
  box-shadow: inset 0 -1px 0 rgba(255,255,255,.10);
}

.envelope[data-state="opened"] .flap{
  margin-top: 10px;
  transform: rotateX(170deg);
  z-index: 0;
}

.side{
  position:absolute;
  inset:0;
  border-radius: 18px;
  z-index: 3;
  pointer-events:none;
}

.side--left{
  background: linear-gradient(180deg, rgba(0,0,0,.06), rgba(0,0,0,.18));
  clip-path: polygon(0 0, 50% 64%, 0 100%);
}

.side--right{
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.10));
  clip-path: polygon(100% 0, 50% 64%, 100% 100%);
}

.env--front{
  z-index: 6;
  background: linear-gradient(180deg, var(--envFront), #b57f67);
  border: 2px solid rgba(0,0,0,.15);
  clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%, 50% 64%);
}

.memoryStack {
  position: absolute;
  width: 86%;
  height: 195%;
  visibility: hidden;
  transform: translateY(56%);
  transition: transform .9s cubic-bezier(.2,.8,.1,1), z-index .2s linear;
  overflow: visible;
}

.envelope[data-state="opened"] .memoryStack {
  transform: translateY(-1%);
  z-index: 10;
  visibility: visible;
}

.letter__paper{
  height: 100%;
  background:
    radial-gradient(800px 400px at 50% 0%, rgba(255,77,109,.10), transparent 55%),
    linear-gradient(180deg, var(--paper), #fff);
  color: var(--ink);
  border-radius: 16px;
  padding: clamp(16px, 3.2vw, 26px);
  box-shadow: 0 18px 55px rgba(0,0,0,.35);
  border: 1px solid rgba(0,0,0,.06);
  overflow: auto;
}

.letter__hi{
  font-family: var(--script);
  font-size: clamp(40px, 6vw, 60px);
  margin: 0 0 6px;
  color: #2a1e2a;
}

.memo-card {
  overflow: scroll;
}

.memo-card p{
  margin: 0 0 12px;
  font-size: clamp(15px, 1.8vw, 18px);
  line-height: 1.55;
}

.letter__sign{ margin-top: 12px; }
.sig{ font-family: var(--script); font-size: 34px; }

.seal{
  position:absolute;
  z-index: 9;
  width: 74px;
  height: 74px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.35);
  background: radial-gradient(40px 40px at 30% 25%, #ff9bb0, var(--rose));
  box-shadow: 0 14px 30px rgba(0,0,0,.35);
  cursor:pointer;
  display:grid;
  place-items:center;
  transform: translateY(45%);
  transition: transform .25s ease, opacity .25s ease;
}

.seal:hover{ transform: translateY(45%) scale(1.02); }

.seal__heart{
  color:#fff;
  font-size: 28px;
  text-shadow: 0 2px 0 rgba(0,0,0,.2);
}

.envelope[data-state="opened"] .seal{
  opacity: 0;
  pointer-events:none;
}

@media (prefers-reduced-motion: reduce){
  .letter, .seal, .flap{ transition:none !important; }
}

/* TUS BOTONES EXACTOS */
.songbtn{
  appearance:none;
  border: 1px solid rgba(0,0,0,.10);
  background: rgba(0,0,0,.04);
  color: var(--ink);
  padding: 10px 12px;
  border-radius: 14px;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:10px;
  margin-top: 10px;
}

.songbtn:hover{ background: rgba(0,0,0,.06); }

.songbtn__icon{
  width: 34px;
  height: 34px;
  border-radius: 12px;
  display:grid;
  place-items:center;
  background: radial-gradient(20px 20px at 30% 25%, #9cffc2, #2bd46a);
  color:#0b1a10;
  font-size: 18px;
  box-shadow: 0 10px 18px rgba(0,0,0,.12);
}

.songbtn__text{
  font-size: 14px;
  letter-spacing: .02em;
}

.memo-card {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 16px;
  transition: all 0.55s cubic-bezier(0.34, 1.3, 0.64, 1);
  cursor: pointer;
  outline: none;
}

.memoryStack[data-active="letter"] .memo-card[data-type="letter"] {
  z-index: 2;
  transform: translateY(0);
  pointer-events: auto;
}

.memoryStack[data-active="letter"] .memo-card[data-type="song"] {
  z-index: 1;
  transform: translateY(60px);
  pointer-events: auto;
  box-shadow: 0 12px 32px rgba(0,0,0,.25);
}

.memoryStack[data-active="song"] .memo-card[data-type="song"] {
  z-index: 2;
  transform: translateY(0);
  pointer-events: auto;
}

.memoryStack[data-active="song"] .memo-card[data-type="letter"] {
  z-index: 1;
  transform: translateY(60px);
  pointer-events: auto;
  box-shadow: 0 12px 32px rgba(0,0,0,.25);
  cursor: pointer;
}

/* Efecto hover sutil cuando asoma */
.memoryStack[data-active="letter"] .memo-card[data-type="song"]:hover {
  transform: translateY(45px);
}

.memoryStack[data-active="song"] .memo-card[data-type="letter"]:hover {
  transform: translateY(50px);
  cursor: pointer;
}

/* Responsive */
@media (max-width: 480px) {
  .memoryStack[data-active="letter"] .memo-card[data-type="song"] {
    transform: translateY(50px);
  }
  
  .memoryStack[data-active="song"] .memo-card[data-type="letter"] {
    transform: translateY(50px);
  }
  
  .memoryStack[data-active="letter"] .memo-card[data-type="song"]:hover {
    transform: translateY(40px);
  }
}


.spotify-polaroid {
  padding: 20px;
  display: flex;
  flex-direction: column;
  background: #fefdfb;
  box-shadow: 
    0 2px 8px rgba(0,0,0,.08),
    0 8px 24px rgba(0,0,0,.12);
}

.songcard__close {
  position: absolute;
  top: 16px;
  right: 16px;
  width: 38px;
  height: 38px;
  border-radius: 50%;
  border: 2px solid rgba(0,0,0,.15);
  background: rgba(255,255,255,.95);
  color: #1a1a1a;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  display: grid;
  place-items: center;
  z-index: 10;
  transition: all 0.2s;
}

.songcard__close:hover {
  background: #fff;
  transform: scale(1.1);
}

.polaroid-frame {
  background: #fff;
  padding: 16px;
  padding-bottom: 20px;
  border: 1px solid rgba(0,0,0,.08);
  box-shadow: 
    0 1px 3px rgba(0,0,0,.06),
    0 4px 12px rgba(0,0,0,.08);
  border-radius: 4px;
}

.polaroid-photo {
  position: relative;
  width: 100%;
  aspect-ratio: 1/1;
  background: #f5f5f5;
  border: 2px solid #000;
  margin-bottom: 12px;
  overflow: hidden;
  padding: 15px;
}

.polaroid-photo img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.polaroid-spotify {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px 0;
  margin-bottom: 12px;
}

.spotify-logo {
  width: 32px;
  height: 32px;
  color: #1DB954;
  flex-shrink: 0;
}

.spotify-logo svg {
  width: 100%;
  height: 100%;
}

.spotify-code {
  flex: 1;
  height: 40px;
  background: #fff;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 4px;
  gap: 2px;
}

.code-bar {
  flex: 1;
  background: #000;
  border-radius: 1px;
  min-height: 20%;
}

.polaroid-info {
  margin-bottom: 16px;
  position: relative;
  padding-right: 50px;
}

.song-title {
  font-size: 18px;
  font-weight: 600;
  color: #1a1a1a;
  margin-bottom: 4px;
  line-height: 1.3;
}

.song-artist {
  font-size: 15px;
  color: #6a6a6a;
  line-height: 1.3;
}

.heart-btn {
  position: absolute;
  top: 0;
  right: 0;
  width: 44px;
  height: 44px;
  border: none;
  background: transparent;
  color: #ccc;
  font-size: 28px;
  cursor: pointer;
  transition: all 0.2s;
  display: grid;
  place-items: center;
}

.heart-btn:hover {
  transform: scale(1.15);
}

.heart-btn.liked {
  color: #ff4444;
}

.polaroid-player {
  border-top: 1px solid rgba(0,0,0,.08);
  padding-top: 12px;
}

.player-time {
  display: flex;
  justify-content: space-between;
  font-size: 13px;
  color: #4a4a4a;
  margin-bottom: 8px;
  font-variant-numeric: tabular-nums;
}

.player-bar {
  position: relative;
  height: 6px;
  background: #e0e0e0;
  border-radius: 3px;
  margin-bottom: 16px;
  cursor: pointer;
}

.player-progress {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  background: #1a1a1a;
  border-radius: 3px;
  width: 0%;
  transition: width 0.1s linear;
}

.player-handle {
  position: absolute;
  top: 50%;
  left: 0%;
  width: 14px;
  height: 14px;
  background: #1a1a1a;
  border: 2px solid #fff;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  opacity: 0;
  transition: opacity 0.2s;
  pointer-events: none;
}

.player-bar:hover .player-handle {
  opacity: 1;
}

.player-controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
}

.ctrl-btn {
  width: 44px;
  height: 44px;
  border: none;
  background: transparent;
  color: #1a1a1a;
  cursor: pointer;
  display: grid;
  place-items: center;
  border-radius: 50%;
  transition: all 0.2s;
}

.ctrl-btn svg {
  width: 24px;
  height: 24px;
}

.ctrl-btn:hover {
  background: rgba(0,0,0,.08);
}

.ctrl-btn--play {
  width: 56px;
  height: 56px;
  background: #1a1a1a;
  color: #fff;
}

.ctrl-btn--play svg {
  width: 28px;
  height: 28px;
}

.ctrl-btn--play:hover {
  background: #000;
  transform: scale(1.05);
}

.ctrl-btn--play.playing svg {
  display: none;
}

.ctrl-btn--play.playing::before {
  content: '❚❚';
  font-size: 20px;
}

@media (max-width: 480px) {
  .polaroid-frame {
    padding: 12px;
    padding-bottom: 16px;
  }
  
  .song-title {
    font-size: 16px;
  }
  
  .song-artist {
    font-size: 14px;
  }
  
  .spotify-code {
    height: 35px;
  }
  
  .ctrl-btn {
    width: 40px;
    height: 40px;
  }
  
  .ctrl-btn--play {
    width: 52px;
    height: 52px;
  }
}